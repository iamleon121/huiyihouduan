# 会议管理 - 新建会议功能开发计划 (TODO List)

## 目标
实现无纸化会议系统中的新建会议功能，允许用户创建会议并上传相关议题的PDF文件，确保信息正确存储到数据库中。

## 任务列表

### 1. 前端实现 (`static/huiyi-meeting.html`, `static/huiyi-meeting.js`)

- **[X] 新增会议基础功能:**
  - [X] 会议管理页面中的"新增会议"按钮 (`#add-meeting-btn`)。
  - [X] 设计并实现模态框 (`#meetingModal`) 用于填写新会议信息。
  - [X] 表单 (`#meetingForm`) 包含会议的基本信息（名称、简介、时间）。
  - [X] 表单支持动态添加/删除议程项 (`#agendaItemsContainer`, `#addAgendaItemBtn`)。
  - [X] 实现表单提交逻辑：收集数据并调用后端 API。

- **[X] 文件上传功能:**
  - [X] 为每个议程项添加文件上传控件，支持文件队列与拖拽上传。
  - [X] 添加文件类型限制（仅允许PDF）。
  - [X] 添加文件大小限制和验证。
  - [X] 显示上传进度指示器。
  - [X] 允许删除已选择的文件。

- **[X] 表单验证与提交:**
  - [X] 添加必填字段验证（会议名称、时间）。
  - [X] 验证议程项名称。
  - [X] 优化表单提交逻辑，处理文件上传和会议信息提交。
  - [X] 添加提交状态指示器和错误处理。

- **[ ] UI/UX优化:**
  - [X] 优化文件上传区域的视觉设计。
  - [X] 添加拖放上传功能。
  - [ ] 改进表单布局，使其在移动设备上也能良好显示。
  - [ ] 添加表单字段提示和帮助信息。

### 2. 后端实现 (`main.py`, `crud.py`, `schemas.py`)

- **[X] API扩展:**
  - [X] 扩展现有的 `POST /api/meetings/` API，支持文件上传。
  - [X] 实现文件上传处理逻辑，包括文件保存和路径记录。

- **[X] 数据模型与验证:**
  - [X] 更新 `schemas.py` 中的 `AgendaItem` 和 `AgendaItemCreate` 以包含文件信息。
  - [X] 确保议程项与文件之间的关联关系正确建立。

- **[X] 文件存储:**
  - [X] 设计文件存储结构（按会议ID和议程项ID组织）。
  - [X] 实现文件保存逻辑。

### 3. 数据库设计

- **[X] 表结构设计:**
  - [X] 确保 `agenda_items` 表能够存储文件名称信息。

### 4. 测试

- **[ ] 手动测试:**
  - [ ] 测试创建包含议程项和文件的会议。
  - [ ] 测试文件上传功能。

## 实现流程

1. **新建会议流程:**
   - 用户在会议管理页面点击"新增会议"按钮。
   - 打开模态框，填写会议基本信息（名称、简介、时间）。
   - 添加一个或多个议程项，每个议程项只包含名称。
   - 为每个议程项上传相关的PDF文件。
   - 提交表单，前端收集所有信息并发送到后端。
   - 后端验证数据，保存会议信息和议程项到数据库。
   - 处理文件上传，保存文件到服务器。
   - 返回成功或失败信息给前端。
   - 前端显示操作结果，成功则刷新会议列表。

## 近期进展（2024年6月）
- 会议管理页面重构，前端UI与交互体验优化。
- 议程项文件上传功能优化，支持文件队列、拖拽上传、上传进度显示。
- 前端表单简化，必填项校验与错误提示增强。
- static/huiyi.js归档至nonuse目录，主前端逻辑迁移至static/huiyi-meeting.js。
- 会议议程项支持PDF文件上传，文件类型与大小校验完善。
- 会议管理相关API接口完善，支持议程项文件信息存储。

## 注意事项

- 确保文件上传安全，防止恶意文件上传。
- 实现适当的错误处理和用户反馈。
- 保持功能简单，遵循最简够用原则。